% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Multiple Imputation Edge Cases},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Multiple Imputation Edge Cases}
\author{}
\date{\vspace{-2.5em}2022-07-22, Leo Murao Watson}

\begin{document}
\maketitle

\hypertarget{special-cases-where-listwise-deletion-is-preferred-over-multiple-imputation}{%
\subsection{Special Cases where Listwise Deletion is Preferred over
Multiple
Imputation}\label{special-cases-where-listwise-deletion-is-preferred-over-multiple-imputation}}

\begin{itemize}
\tightlist
\item
  Let \(Y\) = Ozone, \(X_1\) = Wind, \(X_2\) = Temp, \(X_3\) = Month,
  \(X_4\) = Day
\item
  Will compare Missing Imputation and Listwise Deletion as missing data
  methods.
\item
  Suppose scientifc interest focuses on determining \(\Beta_1\),
  \(\Beta_2\), \(\Beta_3\), \(\Beta_4\) in the linear model
  \(y_i = \alpha + x_1*\Beta_1\) \#\# 1) Exclusively Missing data in
  Response Y
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Governing Equation: y\_i = alpha + x\_1 b\_1 + x\_2 b\_2 + x\_3 b\_3 + x\_4 b\_4 + e\_i}
\CommentTok{\# note alpha is intercept}
\NormalTok{create.data }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{alpha =} \DecValTok{20}\NormalTok{, }\AttributeTok{beta\_1 =} \DecValTok{1}\NormalTok{, }\AttributeTok{beta\_2 =} \DecValTok{2}\NormalTok{, }\AttributeTok{beta\_3 =} \DecValTok{3}\NormalTok{, }\AttributeTok{beta\_4 =} \DecValTok{4}\NormalTok{, }
                        \AttributeTok{sigma2 =} \DecValTok{1}\NormalTok{, }\AttributeTok{n =} \DecValTok{50}\NormalTok{, }\AttributeTok{run =} \DecValTok{1}\NormalTok{) \{}
  \FunctionTok{set.seed}\NormalTok{(}\AttributeTok{seed =}\NormalTok{ run)}
\NormalTok{  x\_1 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}
\NormalTok{  x\_2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}
\NormalTok{  x\_3 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}
\NormalTok{  x\_4 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ beta\_1 }\SpecialCharTok{*}\NormalTok{ x\_1 }\SpecialCharTok{+}\NormalTok{ beta\_2 }\SpecialCharTok{*}\NormalTok{ x\_2 }\SpecialCharTok{+}\NormalTok{ beta\_3 }\SpecialCharTok{*}\NormalTok{ x\_3 }\SpecialCharTok{+}\NormalTok{ beta\_4 }\SpecialCharTok{*}\NormalTok{ x\_4 }\SpecialCharTok{+}\NormalTok{ alpha }\SpecialCharTok{+} \FunctionTok{rnorm}\NormalTok{(n, }\AttributeTok{sd =} \FunctionTok{sqrt}\NormalTok{(sigma2))}
  \FunctionTok{cbind}\NormalTok{(}\StringTok{"Ozone"} \OtherTok{=}\NormalTok{ y, }\StringTok{"Wind"}\OtherTok{=}\NormalTok{ x\_1, }\StringTok{"Temp"} \OtherTok{=}\NormalTok{ x\_2, }\StringTok{"Month"} \OtherTok{=}\NormalTok{ x\_3, }\StringTok{"Day"} \OtherTok{=}\NormalTok{ x\_4)}
\NormalTok{\}}

\NormalTok{MCAR.make.missing }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, }\AttributeTok{p =} \FloatTok{0.5}\NormalTok{)\{}
\NormalTok{  rx }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(data), }\DecValTok{1}\NormalTok{, p)}
\NormalTok{  data[rx }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, }\StringTok{"Ozone"}\NormalTok{] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{  data}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{missing-imputation}{%
\subsubsection{Missing Imputation}\label{missing-imputation}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simulate\_MI2 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{runs =} \DecValTok{100}\NormalTok{) \{}
\NormalTok{  res }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{dim =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, runs, }\DecValTok{3}\NormalTok{))}
\NormalTok{  times }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{dim =} \FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
  \FunctionTok{dimnames}\NormalTok{(res) }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Intercept"}\NormalTok{, }\StringTok{"Wind"}\NormalTok{, }\StringTok{"Temp"}\NormalTok{, }\StringTok{"Month"}\NormalTok{, }\StringTok{"Day"}\NormalTok{),}
                        \FunctionTok{as.character}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{runs), }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5\%"}\NormalTok{, }\StringTok{"97.5\%"}\NormalTok{))}
\NormalTok{  sim\_dataset }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{create.data}\NormalTok{(}\AttributeTok{n =} \DecValTok{200}\NormalTok{))}
  \ControlFlowTok{for}\NormalTok{ (run }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{runs)\{}
      \CommentTok{\# Note that time is only measured for the MI/imp steps }
      \CommentTok{\# (i.e. filtering, predicting)}
\NormalTok{    missingness\_sim\_dataset }\OtherTok{\textless{}{-}} \FunctionTok{MCAR.make.missing}\NormalTok{(sim\_dataset, }\AttributeTok{p =} \FloatTok{0.7}\NormalTok{)}
\NormalTok{    start\_time }\OtherTok{\textless{}{-}} \FunctionTok{Sys.time}\NormalTok{()}
\NormalTok{    imp\_MI }\OtherTok{\textless{}{-}} \FunctionTok{mice}\NormalTok{(missingness\_sim\_dataset, }\AttributeTok{print =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{    fit }\OtherTok{\textless{}{-}} \FunctionTok{with}\NormalTok{(imp\_MI, }\FunctionTok{lm}\NormalTok{(Ozone }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Wind }\SpecialCharTok{+}\NormalTok{ Temp }\SpecialCharTok{+}\NormalTok{ Month }\SpecialCharTok{+}\NormalTok{ Day))}
\NormalTok{    end\_time }\OtherTok{\textless{}{-}} \FunctionTok{Sys.time}\NormalTok{()}
\NormalTok{    tab }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(}\FunctionTok{pool}\NormalTok{(fit), }\StringTok{"all"}\NormalTok{, }\AttributeTok{conf.int =} \ConstantTok{TRUE}\NormalTok{)  }
\NormalTok{    res[}\DecValTok{1}\NormalTok{, run, ] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(tab[}\DecValTok{1}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5 \%"}\NormalTok{, }\StringTok{"97.5 \%"}\NormalTok{)])  }
\NormalTok{    res[}\DecValTok{2}\NormalTok{, run, ] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(tab[}\DecValTok{2}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5 \%"}\NormalTok{, }\StringTok{"97.5 \%"}\NormalTok{)])}
\NormalTok{    res[}\DecValTok{3}\NormalTok{, run, ] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(tab[}\DecValTok{3}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5 \%"}\NormalTok{, }\StringTok{"97.5 \%"}\NormalTok{)])}
\NormalTok{    res[}\DecValTok{4}\NormalTok{, run, ] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(tab[}\DecValTok{4}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5 \%"}\NormalTok{, }\StringTok{"97.5 \%"}\NormalTok{)])}
\NormalTok{    res[}\DecValTok{5}\NormalTok{, run, ] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(tab[}\DecValTok{5}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5 \%"}\NormalTok{, }\StringTok{"97.5 \%"}\NormalTok{)])}
    
\NormalTok{    times[run, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(end\_time }\SpecialCharTok{{-}}\NormalTok{ start\_time)}
\NormalTok{  \}}
  \FunctionTok{list}\NormalTok{(res, times)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Run 100 iterations of multiple imputations and store}
\NormalTok{res\_MI2 }\OtherTok{\textless{}{-}} \FunctionTok{simulate\_MI2}\NormalTok{(}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain confidence intervals \& estimates for all coefficients, intercept.}
\FunctionTok{apply}\NormalTok{(res\_MI2[[}\DecValTok{1}\NormalTok{]], }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{), mean, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             estimate       2.5%     97.5%
## Intercept 20.0143580 19.8033332 20.225383
## Wind       0.9696197  0.7402856  1.198954
## Temp       2.0046883  1.7931717  2.216205
## Month      2.9328688  2.7315215  3.134216
## Day        3.9639165  3.7675220  4.160311
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mean time for iterations of multiple imputation}
\NormalTok{times }\OtherTok{\textless{}{-}}\NormalTok{ res\_MI2[[}\DecValTok{2}\NormalTok{]]}
\FunctionTok{mean}\NormalTok{(times)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.08342375
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Evaluating estimates for all parameters of interest.}
\NormalTok{res }\OtherTok{\textless{}{-}}\NormalTok{ res\_MI2[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{true }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{RB }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"estimate"}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{ true}
\NormalTok{PB }\OtherTok{\textless{}{-}} \DecValTok{100} \SpecialCharTok{*} \FunctionTok{abs}\NormalTok{((}\FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"estimate"}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{ true)}\SpecialCharTok{/}\NormalTok{ true)}
\NormalTok{CR }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"2.5\%"}\NormalTok{] }\SpecialCharTok{\textless{}}\NormalTok{ true }\SpecialCharTok{\&}\NormalTok{ true }\SpecialCharTok{\textless{}}\NormalTok{ res[,, }\StringTok{"97.5\%"}\NormalTok{])}
\NormalTok{AW }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"97.5\%"}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ res[,, }\StringTok{"2.5\%"}\NormalTok{])}
\NormalTok{RMSE }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{rowMeans}\NormalTok{((res[,, }\StringTok{"estimate"}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ true)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
\FunctionTok{data.frame}\NormalTok{(RB, PB, CR, AW, RMSE)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                     RB         PB   CR        AW       RMSE
## Intercept  0.014358004 0.07179002 1.00 0.4220497 0.06799295
## Wind      -0.030380315 3.03803153 0.99 0.4586681 0.08021248
## Temp       0.004688331 0.23441653 0.99 0.4230333 0.08433476
## Month     -0.067131164 2.23770548 0.90 0.4026948 0.11735800
## Day       -0.036083529 0.90208824 0.97 0.3927890 0.07891836
\end{verbatim}

\hypertarget{listwise-deletion}{%
\subsubsection{Listwise Deletion}\label{listwise-deletion}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simulate\_LD }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{runs =} \DecValTok{100}\NormalTok{)\{}
\NormalTok{  res }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{dim =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, runs, }\DecValTok{3}\NormalTok{))}
  \FunctionTok{dimnames}\NormalTok{(res) }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Intercept"}\NormalTok{, }\StringTok{"Wind"}\NormalTok{, }\StringTok{"Temp"}\NormalTok{, }\StringTok{"Month"}\NormalTok{, }\StringTok{"Day"}\NormalTok{),}
                        \FunctionTok{as.character}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{runs), }\FunctionTok{c}\NormalTok{(}\StringTok{"estimate"}\NormalTok{, }\StringTok{"2.5\%"}\NormalTok{, }\StringTok{"97.5\%"}\NormalTok{))}
\NormalTok{  times }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{dim =} \FunctionTok{c}\NormalTok{(runs, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{  sim\_dataset }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{create.data}\NormalTok{(}\AttributeTok{n =} \DecValTok{200}\NormalTok{))}
  \CommentTok{\# Note that time is only measured for the LD/imp steps (i.e. filtering, predicting)}
  \ControlFlowTok{for}\NormalTok{ (run }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{runs)\{}
\NormalTok{    missingness\_sim\_dataset }\OtherTok{\textless{}{-}} \FunctionTok{MCAR.make.missing}\NormalTok{(sim\_dataset, }\AttributeTok{p =} \FloatTok{0.7}\NormalTok{)}
\NormalTok{    start\_time }\OtherTok{\textless{}{-}} \FunctionTok{Sys.time}\NormalTok{()}
\NormalTok{    filtered\_sim\_dataset }\OtherTok{\textless{}{-}}\NormalTok{ missingness\_sim\_dataset }\SpecialCharTok{\%\textgreater{}\%} 
      \FunctionTok{select}\NormalTok{(Ozone, Wind, Temp, Month, Day) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(Ozone))}
\NormalTok{    fit }\OtherTok{\textless{}{-}} \FunctionTok{with}\NormalTok{(filtered\_sim\_dataset, }\FunctionTok{lm}\NormalTok{(Ozone }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Wind }\SpecialCharTok{+}\NormalTok{ Temp }\SpecialCharTok{+}\NormalTok{ Month }\SpecialCharTok{+}\NormalTok{ Day))}
\NormalTok{    end\_time }\OtherTok{\textless{}{-}} \FunctionTok{Sys.time}\NormalTok{()}
\NormalTok{    times[run, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(end\_time }\SpecialCharTok{{-}}\NormalTok{ start\_time)}
    \CommentTok{\# loop over each variable. Note we do the imputation just ONCE b/c LD is }
    \CommentTok{\# deterministic.}
    \ControlFlowTok{for}\NormalTok{ (var }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{      edges }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{((}\FunctionTok{confint}\NormalTok{(fit)[var,]))}
\NormalTok{      estimate }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(fit}\SpecialCharTok{$}\NormalTok{coefficients)[var]}
\NormalTok{      interval }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(estimate, edges)}
\NormalTok{      res[var, run, ] }\OtherTok{\textless{}{-}}\NormalTok{ interval}
\NormalTok{      \}}
  
\NormalTok{  \}}
  \FunctionTok{list}\NormalTok{(res, times)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result\_LD }\OtherTok{\textless{}{-}} \FunctionTok{simulate\_LD}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result\_LD}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## , , estimate
## 
##                   1         2         3         4         5         6         7
## Intercept 20.003321 20.015768 20.010837 19.998930 19.947358 20.105600 20.064057
## Wind       1.037141  1.083972  1.128518  1.027809  1.086958  1.002644  1.108576
## Temp       2.152984  2.017021  1.901823  2.082825  2.089457  2.035710  2.056996
## Month      3.047609  2.994354  3.042577  2.995182  3.041711  2.988730  3.023066
## Day        4.023437  4.144157  3.968827  4.061362  4.077073  3.958778  4.060139
##                   8          9        10        11         12        13
## Intercept 20.083190 19.9781517 19.976867 20.003286 19.9645809 20.064936
## Wind       1.009682  0.9850046  1.082565  1.025120  0.9438669  1.026715
## Temp       2.180287  2.0909444  2.109974  2.153904  2.0596866  2.006302
## Month      2.898930  3.0672133  3.071882  2.996088  2.9711643  3.091413
## Day        3.964512  4.1115506  4.042570  4.040484  4.0389507  4.066106
##                  14         15        16        17        18         19
## Intercept 20.049657 19.9384135 20.058550 20.043318 19.966357 20.1417955
## Wind       1.024880  0.9445119  1.079313  1.010200  1.018839  0.9840512
## Temp       2.136507  1.9595926  2.075206  2.034701  2.096422  2.0816626
## Month      3.085691  2.9989799  2.957433  3.054197  3.005731  3.0008766
## Day        4.051346  3.9797702  4.000051  4.090649  4.021710  3.9716410
##                  20        21        22        23         24        25
## Intercept 20.019522 20.004191 20.061675 19.991720 20.0386921 19.929605
## Wind       1.019155  1.003099  1.033108  1.139842  0.9680741  1.069295
## Temp       2.070965  2.008224  2.081074  2.180490  2.0621155  1.969861
## Month      2.957550  3.007751  3.030249  2.959512  3.0327833  2.999505
## Day        4.104074  4.057372  4.045085  3.984031  4.0403488  4.031668
##                  26        27        28        29        30        31
## Intercept 20.008152 20.044853 20.038759 20.005725 20.017951 20.022265
## Wind       1.045463  1.006000  1.021061  1.037472  1.039428  1.098838
## Temp       2.065145  2.078415  2.090093  2.056331  2.068289  2.068593
## Month      3.048904  3.053008  2.983642  2.961179  2.981709  2.933019
## Day        4.092233  4.045230  4.085229  4.015419  4.031455  4.031173
##                   32        33        34        35         36        37
## Intercept 20.0422408 20.000941 19.998037 20.003874 20.0637733 20.027382
## Wind       0.9896938  1.069824  0.944793  1.086694  0.9648823  1.042573
## Temp       2.0595907  2.117345  2.013715  1.989313  2.1386670  1.996681
## Month      3.0278017  2.990433  3.008874  3.024896  3.1085027  3.034916
## Day        4.0423264  4.037044  4.013650  3.955432  4.0129122  4.045958
##                   38        39        40         41         42        43
## Intercept 19.9596888 20.011343 20.009181 19.9571321 19.9849949 20.131458
## Wind       0.9409095  1.020835  1.114084  0.9452183  0.9855463  1.030108
## Temp       1.9925633  2.024948  2.121069  2.0332421  2.1081829  2.113240
## Month      3.0797644  3.020509  3.011415  2.9394466  3.0860050  3.064314
## Day        4.0700005  4.021255  4.019702  3.9755968  4.0569788  4.092518
##                  44         45         46        47        48        49
## Intercept 19.994084 20.1130570 19.9931163 20.020943 19.984573 19.939160
## Wind       1.072922  0.9966509  0.9400619  1.054561  1.081773  1.047502
## Temp       2.139779  2.0608024  2.0479524  2.062085  2.050155  2.113888
## Month      3.062716  3.0749840  3.0615550  3.047669  3.015734  2.925337
## Day        4.012565  4.0209685  4.0210374  4.042314  4.008852  4.065996
##                   50        51        52         53         54        55
## Intercept 19.9324099 19.965625 19.984483 20.0738380 19.9995028 19.933642
## Wind       0.9485368  1.082642  1.032195  0.9183937  0.9837232  1.020090
## Temp       2.0627989  2.104125  2.106851  2.0469176  2.0465742  1.971614
## Month      3.0764079  3.043323  3.009923  3.0132698  2.9413996  3.032496
## Day        4.0447772  3.987687  4.084740  4.0173931  4.0460733  4.037188
##                  56        57        58        59        60        61        62
## Intercept 20.021008 19.975556 19.911444 20.014191 20.075840 20.019752 19.978162
## Wind       1.041304  1.019480  1.035762  1.032163  1.065144  1.014008  1.060298
## Temp       2.162051  2.124506  2.001617  2.080898  2.089259  2.121751  2.018034
## Month      3.041558  3.075718  2.986189  3.044589  2.982849  3.021486  3.026715
## Day        4.028149  4.068710  3.975915  3.990247  4.089932  4.066257  3.980229
##                  63        64        65        66        67         68
## Intercept 20.023484 19.985210 20.060673 19.970505 20.041198 20.0525194
## Wind       1.035425  1.002783  1.016701  1.068865  1.090828  0.9649025
## Temp       2.094151  1.968100  2.001645  2.123457  2.070238  2.1417425
## Month      3.029020  3.040652  2.984075  2.993447  3.014987  3.0851145
## Day        4.040070  4.017218  4.054391  3.963016  4.017525  4.0089007
##                   69         70        71        72         73        74
## Intercept 20.0410815 19.9556822 19.984401 20.035001 20.0384191 20.030319
## Wind       0.9936859  0.8867194  1.004671  1.045523  0.9524052  1.029091
## Temp       2.1169112  2.1066671  2.088427  2.076539  2.0781836  2.119932
## Month      3.0389491  3.0533755  3.001965  3.024640  3.0601273  3.039218
## Day        4.0371285  4.0432947  4.065540  4.013161  4.0229171  4.043725
##                  75         76        77        78        79        80
## Intercept 20.064532 19.9688914 19.993116 20.021918 20.017408 20.019937
## Wind       1.059214  0.9485724  1.048894  0.964032  1.018724  0.927208
## Temp       2.057510  2.0431104  2.097284  2.036335  1.997948  2.160991
## Month      3.039083  3.0344909  3.038694  3.095135  3.045156  3.033178
## Day        4.072915  4.0685225  4.033792  4.001639  4.071616  3.996016
##                  81        82        83         84        85        86
## Intercept 19.991239 20.049126 19.988786 20.0440072 20.106111 19.912224
## Wind       1.021673  1.090109  1.034271  0.9851454  1.055993  1.055843
## Temp       2.096626  2.033262  2.108978  2.1120569  2.039288  1.966975
## Month      2.980902  3.065678  2.994734  2.9773442  3.053479  3.043719
## Day        4.044227  4.113124  4.005037  4.0445123  3.993478  4.003578
##                   87        88         89         90        91        92
## Intercept 20.0346244 20.009360 19.9119198 20.0566188 20.053701 19.917339
## Wind       0.9956467  1.030348  0.9431722  0.9196187  1.008187  1.062301
## Temp       2.1187457  2.184483  2.0001327  2.0724278  2.089817  2.099248
## Month      3.0537162  3.006776  3.0858719  2.9631297  3.003248  3.021814
## Day        4.0857711  4.045708  4.0707488  4.0284203  4.003241  4.056590
##                  93        94        95        96         97        98
## Intercept 20.004867 20.015495 20.032291 20.032332 20.0525146 20.081794
## Wind       1.038193  1.128338  1.016287  1.060699  0.9739591  1.053531
## Temp       2.100043  2.111843  2.079276  1.975042  2.0913532  1.958678
## Month      3.038741  3.048310  2.977204  2.994408  3.0109506  3.024549
## Day        3.963024  4.033460  4.079493  3.955552  4.0885009  4.039803
##                  99       100
## Intercept 20.010547 20.085253
## Wind       1.026776  1.103588
## Temp       2.032878  2.067446
## Month      3.013089  3.027119
## Day        3.933610  4.029188
## 
## , , 2.5%
## 
##                    1          2          3          4          5          6
## Intercept 19.8179598 19.8287542 19.8381595 19.8185634 19.7638263 19.9173142
## Wind       0.8440998  0.8718505  0.9356324  0.8332448  0.8906084  0.7997202
## Temp       1.9721164  1.8328669  1.7382100  1.9093092  1.9073044  1.8518370
## Month      2.8650122  2.8218372  2.8816304  2.8228836  2.8749186  2.8194705
## Day        3.8544032  3.9715063  3.8061692  3.8930595  3.9126056  3.7891736
##                    7          8          9         10         11         12
## Intercept 19.8741679 19.8941728 19.7942448 19.8029925 19.8186837 19.7746637
## Wind       0.9049398  0.7961718  0.7767721  0.8890814  0.8244099  0.7382261
## Temp       1.8722595  1.9895596  1.9011498  1.9379750  1.9637712  1.8777028
## Month      2.8488214  2.7200676  2.8826178  2.9104600  2.8098786  2.7936045
## Day        3.8768484  3.7916426  3.9492552  3.8826719  3.8697320  3.8629801
##                   13         14         15         16         17         18
## Intercept 19.8880369 19.8605711 19.7513533 19.8627769 19.8660327 19.7804764
## Wind       0.8267883  0.8265039  0.7469707  0.8703637  0.8247666  0.8233974
## Temp       1.8277742  1.9494984  1.7718266  1.8816611  1.8547418  1.9113365
## Month      2.9335135  2.9083229  2.8288020  2.7626835  2.8903441  2.8292643
## Day        3.9126780  3.8840830  3.8164580  3.8244862  3.9279514  3.8591430
##                   19         20         21         22         23         24
## Intercept 19.9691715 19.8367378 19.8183334 19.8608057 19.8096214 19.8614078
## Wind       0.7797419  0.8201078  0.8021721  0.8063547  0.9490898  0.7756026
## Temp       1.9083602  1.8863051  1.8213054  1.8875208  1.9874263  1.8980069
## Month      2.8491599  2.7873554  2.8336913  2.8481655  2.7782896  2.8755291
## Day        3.8146055  3.9362366  3.8921646  3.8667285  3.8093223  3.8772163
##                  25         26         27         28         29         30
## Intercept 19.740347 19.8211040 19.8613354 19.8592868 19.8246050 19.8381824
## Wind       0.850232  0.8434189  0.8014872  0.8197417  0.8365522  0.8489334
## Temp       1.784385  1.8816975  1.8971446  1.9092610  1.8830383  1.8856895
## Month      2.815227  2.8764937  2.8764017  2.8126216  2.7741920  2.8100700
## Day        3.860050  3.9274136  3.8778040  3.9235187  3.8483059  3.8759076
##                   31         32         33         34         35         36
## Intercept 19.8391956 19.8706918 19.8189589 19.8155671 19.8314426 19.8712004
## Wind       0.9031515  0.7901127  0.8765064  0.7575978  0.8867287  0.7549352
## Temp       1.8941664  1.8904783  1.9234312  1.8411174  1.8242900  1.9412262
## Month      2.7624267  2.8677080  2.8081642  2.8470965  2.8665159  2.9345357
## Day        3.8603214  3.8851356  3.8651748  3.8373913  3.8020031  3.8324868
##                   37         38         39         40         41         42
## Intercept 19.8333826 19.7816281 19.8350089 19.8385082 19.7830712 19.8115733
## Wind       0.8325585  0.7531668  0.8218153  0.9268478  0.7444658  0.7931262
## Temp       1.7991830  1.8123102  1.8668437  1.9560807  1.8558089  1.9245214
## Month      2.8583036  2.9145049  2.8628590  2.8568101  2.7799863  2.9245515
## Day        3.8625276  3.9105154  3.8586566  3.8583608  3.8111136  3.9034048
##                  43         44         45         46         47         48
## Intercept 19.942673 19.8232493 19.9288995 19.8144045 19.8293924 19.8018301
## Wind       0.824719  0.8864917  0.7945247  0.7392733  0.8583431  0.8764993
## Temp       1.917770  1.9769832  1.8757308  1.8632552  1.8824266  1.8717927
## Month      2.889904  2.8983084  2.8989823  2.8961061  2.8567835  2.8548065
## Day        3.912488  3.8569001  3.8493710  3.8560413  3.8713227  3.8473804
##                   49         50         51         52         53         54
## Intercept 19.7736998 19.7420896 19.7920588 19.7959022 19.8855682 19.8188378
## Wind       0.8641883  0.7365841  0.8914626  0.8280646  0.7059555  0.7864567
## Temp       1.9462970  1.8721511  1.9258835  1.9248509  1.8565545  1.8675683
## Month      2.7730618  2.8954109  2.8910280  2.8241016  2.8422779  2.7711308
## Day        3.9156687  3.8655131  3.8215080  3.9134946  3.8478221  3.8670713
##                   55         56         57        58         59         60
## Intercept 19.7445034 19.8517287 19.7808339 19.717756 19.8301723 19.8878613
## Wind       0.8103642  0.8612851  0.8105246  0.816534  0.8358348  0.8579801
## Temp       1.7811088  2.0000887  1.9338753  1.818287  1.8945261  1.9063389
## Month      2.8637175  2.8794580  2.8925286  2.797095  2.8775583  2.8150679
## Day        3.8528254  3.8767390  3.8885107  3.787389  3.8236310  3.9067172
##                   61         62         63         64         65         66
## Intercept 19.8337583 19.7984579 19.8396954 19.8088492 19.8756938 19.7792443
## Wind       0.8097626  0.8651876  0.8288687  0.8220142  0.8163469  0.8747403
## Temp       1.9358482  1.8392065  1.9088907  1.7951690  1.8246898  1.9255824
## Month      2.8461793  2.8612212  2.8546288  2.8793583  2.8059268  2.8164241
## Day        3.9029873  3.8164561  3.8698001  3.8581802  3.8706953  3.7856250
##                  67         68        69         70         71         72
## Intercept 19.848793 19.8732912 19.858976 19.7900012 19.8124149 19.8338614
## Wind       0.894036  0.7730203  0.791687  0.7085947  0.8256492  0.8251253
## Temp       1.881562  1.9579735  1.935759  1.9469758  1.9174266  1.8823771
## Month      2.843957  2.9207871  2.864001  2.9043514  2.8373011  2.8419518
## Day        3.840083  3.8445988  3.861547  3.8927607  3.9063071  3.8278033
##                   73         74         75         76         77         78
## Intercept 19.8610044 19.8678708 19.8867461 19.7763192 19.8110334 19.8395120
## Wind       0.7694384  0.8465584  0.8655348  0.7397588  0.8577474  0.7497521
## Temp       1.9119353  1.9555657  1.8881259  1.8579055  1.9134178  1.8509586
## Month      2.9003766  2.8781091  2.8685627  2.8612236  2.8600973  2.9056272
## Day        3.8657309  3.8995742  3.9162093  3.8906856  3.8728881  3.8279592
##                   79         80         81         82         83         84
## Intercept 19.8385720 19.8364232 19.8115923 19.8519140 19.7871096 19.8602551
## Wind       0.8228961  0.7329378  0.8307565  0.8814128  0.8272496  0.7829581
## Temp       1.8240316  1.9839044  1.9240572  1.8393543  1.9043264  1.9387321
## Month      2.8827349  2.8607914  2.8161773  2.8755604  2.8042542  2.8080571
## Day        3.9096573  3.8350266  3.8781718  3.9366840  3.8135914  3.8710370
##                   85         86         87         88         89         90
## Intercept 19.9255655 19.7375474 19.8503213 19.8277070 19.7390706 19.8671481
## Wind       0.8647665  0.8623723  0.8039997  0.8401406  0.7574213  0.7063778
## Temp       1.8664678  1.8063613  1.9359669  2.0072108  1.8306433  1.8845384
## Month      2.8957337  2.8838474  2.8917569  2.8341760  2.9239501  2.7650776
## Day        3.8286957  3.8422880  3.9195675  3.8872343  3.9153735  3.8414099
##                   91         92         93         94         95         96
## Intercept 19.8701758 19.7413965 19.8281307 19.8158329 19.8492871 19.8612305
## Wind       0.8081392  0.8710241  0.8330178  0.9028811  0.8159082  0.8689759
## Temp       1.8907115  1.9365531  1.9251399  1.9056736  1.8974014  1.8058181
## Month      2.8356238  2.8638944  2.8729178  2.8500032  2.8080608  2.8373856
## Day        3.8284977  3.8992281  3.7950134  3.8500250  3.9140603  3.7924313
##                   97         98         99        100
## Intercept 19.8806329 19.9027153 19.8300354 19.9113853
## Wind       0.7945666  0.8568266  0.8282386  0.9106234
## Temp       1.9162764  1.7724337  1.8323156  1.8883172
## Month      2.8548652  2.8560617  2.8327488  2.8651488
## Day        3.9294901  3.8705355  3.7702641  3.8682883
## 
## , , 97.5%
## 
##                   1         2         3         4         5         6         7
## Intercept 20.188682 20.202781 20.183514 20.179297 20.130889 20.293886 20.253946
## Wind       1.230182  1.296093  1.321403  1.222373  1.283308  1.205567  1.312212
## Temp       2.333852  2.201175  2.065436  2.256340  2.271609  2.219583  2.241732
## Month      3.230206  3.166872  3.203524  3.167480  3.208504  3.157990  3.197311
## Day        4.192471  4.316807  4.131484  4.229665  4.241541  4.128382  4.243429
##                   8         9        10        11        12        13        14
## Intercept 20.272207 20.162059 20.150741 20.187889 20.154498 20.241835 20.238744
## Wind       1.223191  1.193237  1.276050  1.225830  1.149508  1.226642  1.223256
## Temp       2.371014  2.280739  2.281973  2.344036  2.241670  2.184830  2.323516
## Month      3.077793  3.251809  3.233305  3.182298  3.148724  3.249312  3.263060
## Day        4.137382  4.273846  4.202469  4.211235  4.214921  4.219534  4.218608
##                  15        16        17        18        19        20        21
## Intercept 20.125474 20.254324 20.220604 20.152238 20.314420 20.202307 20.190049
## Wind       1.142053  1.288262  1.195634  1.214280  1.188361  1.218203  1.204025
## Temp       2.147359  2.268750  2.214661  2.281507  2.254965  2.255624  2.195142
## Month      3.169158  3.152182  3.218050  3.182197  3.152593  3.127744  3.181811
## Day        4.143082  4.175616  4.253347  4.184277  4.128676  4.271912  4.222579
##                  22        23        24        25        26        27        28
## Intercept 20.262544 20.173818 20.215976 20.118864 20.195201 20.228371 20.218232
## Wind       1.259861  1.330594  1.160546  1.288357  1.247507  1.210513  1.222381
## Temp       2.274628  2.373553  2.226224  2.155337  2.248592  2.259686  2.270924
## Month      3.212332  3.140734  3.190037  3.183784  3.221314  3.229614  3.154663
## Day        4.223441  4.158740  4.203481  4.203285  4.257053  4.212655  4.246940
##                  29        30        31        32        33        34        35
## Intercept 20.186846 20.197720 20.205334 20.213790 20.182923 20.180506 20.176306
## Wind       1.238392  1.229923  1.294524  1.189275  1.263142  1.131988  1.286660
## Temp       2.229625  2.250888  2.243020  2.228703  2.311258  2.186313  2.154335
## Month      3.148166  3.153349  3.103610  3.187895  3.172701  3.170652  3.183276
## Day        4.182531  4.187003  4.202024  4.199517  4.208913  4.189909  4.108860
##                  36        37        38        39        40        41        42
## Intercept 20.256346 20.221381 20.137750 20.187677 20.179854 20.131193 20.158417
## Wind       1.174829  1.252588  1.128652  1.219854  1.301320  1.145971  1.177966
## Temp       2.336108  2.194179  2.172816  2.183052  2.286057  2.210675  2.291844
## Month      3.282470  3.211529  3.245024  3.178158  3.166020  3.098907  3.247459
## Day        4.193338  4.229389  4.229486  4.183854  4.181044  4.140080  4.210553
##                  43        44        45        46        47        48        49
## Intercept 20.320243 20.164920 20.297215 20.171828 20.212494 20.167316 20.104621
## Wind       1.235497  1.259352  1.198777  1.140851  1.250778  1.287047  1.230816
## Temp       2.308711  2.302575  2.245874  2.232650  2.241743  2.228518  2.281479
## Month      3.238724  3.227123  3.250986  3.227004  3.238554  3.176662  3.077611
## Day        4.272547  4.168230  4.192566  4.186034  4.213306  4.170324  4.216324
##                  50        51        52        53        54        55        56
## Intercept 20.122730 20.139192 20.173063 20.262108 20.180168 20.122780 20.190288
## Wind       1.160490  1.273822  1.236326  1.130832  1.180990  1.229815  1.221323
## Temp       2.253447  2.282366  2.288851  2.237281  2.225580  2.162119  2.324014
## Month      3.257405  3.195618  3.195743  3.184262  3.111668  3.201275  3.203658
## Day        4.224041  4.153865  4.255986  4.186964  4.225075  4.221551  4.179559
##                  57        58        59        60        61        62        63
## Intercept 20.170279 20.105132 20.198211 20.263819 20.205747 20.157866 20.207273
## Wind       1.228435  1.254989  1.228491  1.272308  1.218254  1.255407  1.241982
## Temp       2.315136  2.184947  2.267270  2.272180  2.307653  2.196862  2.279411
## Month      3.258908  3.175283  3.211619  3.150629  3.196792  3.192210  3.203410
## Day        4.248910  4.164441  4.156863  4.273146  4.229526  4.144003  4.210339
##                  64        65        66        67        68        69        70
## Intercept 20.161571 20.245653 20.161765 20.233602 20.231748 20.223187 20.121363
## Wind       1.183552  1.217055  1.262990  1.287620  1.156785  1.195685  1.064844
## Temp       2.141031  2.178600  2.321332  2.258915  2.325511  2.298063  2.266359
## Month      3.201945  3.162223  3.170470  3.186017  3.249442  3.213897  3.202400
## Day        4.176257  4.238087  4.140406  4.194967  4.173203  4.212710  4.193829
##                  71        72        73        74        75        76        77
## Intercept 20.156387 20.236141 20.215834 20.192768 20.242318 20.161464 20.175198
## Wind       1.183692  1.265921  1.135372  1.211623  1.252893  1.157386  1.240040
## Temp       2.259428  2.270702  2.244432  2.284299  2.226894  2.228315  2.281149
## Month      3.166628  3.207328  3.219878  3.200328  3.209603  3.207758  3.217291
## Day        4.224773  4.198518  4.180103  4.187876  4.229622  4.246359  4.194696
##                  78        79        80        81        82        83        84
## Intercept 20.204324 20.196245 20.203450 20.170886 20.246338 20.190463 20.227759
## Wind       1.178312  1.214552  1.121478  1.212590  1.298805  1.241291  1.187333
## Temp       2.221711  2.171865  2.338077  2.269195  2.227170  2.313629  2.285382
## Month      3.284642  3.207578  3.205564  3.145627  3.255795  3.185215  3.146631
## Day        4.175318  4.233574  4.157006  4.210283  4.289564  4.196483  4.217988
##                  85        86        87        88        89        90        91
## Intercept 20.286657 20.086901 20.218927 20.191013 20.084769 20.246090 20.237226
## Wind       1.247219  1.249314  1.187294  1.220556  1.128923  1.132860  1.208234
## Temp       2.212107  2.127589  2.301524  2.361755  2.169622  2.260317  2.288923
## Month      3.211224  3.203591  3.215676  3.179377  3.247794  3.161182  3.170872
## Day        4.158261  4.164868  4.251975  4.204182  4.226124  4.215431  4.177985
##                  92        93        94        95        96        97        98
## Intercept 20.093282 20.181604 20.215156 20.215295 20.203434 20.224396 20.260872
## Wind       1.253577  1.243368  1.353794  1.216665  1.252421  1.153352  1.250236
## Temp       2.261943  2.274947  2.318013  2.261151  2.144266  2.266430  2.144921
## Month      3.179734  3.204565  3.246617  3.146347  3.151431  3.167036  3.193036
## Day        4.213952  4.131034  4.216894  4.244926  4.118674  4.247512  4.209071
##                  99       100
## Intercept 20.191058 20.259121
## Wind       1.225313  1.296553
## Temp       2.233441  2.246574
## Month      3.193430  3.189089
## Day        4.096957  4.190087
## 
## 
## [[2]]
## , , 1
## 
##               [,1]
##   [1,] 0.016333103
##   [2,] 0.008080006
##   [3,] 0.007200956
##   [4,] 0.006793976
##   [5,] 0.006958961
##   [6,] 0.008416891
##   [7,] 0.006945133
##   [8,] 0.006861925
##   [9,] 0.007452011
##  [10,] 0.007692814
##  [11,] 0.008959055
##  [12,] 0.007246971
##  [13,] 0.007470131
##  [14,] 0.006834984
##  [15,] 0.009327888
##  [16,] 0.006539822
##  [17,] 0.006392956
##  [18,] 0.007060051
##  [19,] 0.007957935
##  [20,] 0.006605864
##  [21,] 0.006766081
##  [22,] 0.006590128
##  [23,] 0.006403923
##  [24,] 0.006438017
##  [25,] 0.006415129
##  [26,] 0.006854057
##  [27,] 0.007451773
##  [28,] 0.006797075
##  [29,] 0.010148048
##  [30,] 0.006819963
##  [31,] 0.006726027
##  [32,] 0.006583929
##  [33,] 0.006385803
##  [34,] 0.007413149
##  [35,] 0.007260084
##  [36,] 0.006536007
##  [37,] 0.006745100
##  [38,] 0.006540060
##  [39,] 0.006455898
##  [40,] 0.006532907
##  [41,] 0.006489038
##  [42,] 0.006554842
##  [43,] 0.006499052
##  [44,] 0.010684013
##  [45,] 0.006844044
##  [46,] 0.007434845
##  [47,] 0.006654978
##  [48,] 0.006557941
##  [49,] 0.006489992
##  [50,] 0.006531000
##  [51,] 0.006536007
##  [52,] 0.006428957
##  [53,] 0.006423950
##  [54,] 0.007667065
##  [55,] 0.006767988
##  [56,] 0.006424904
##  [57,] 0.006742001
##  [58,] 0.011732101
##  [59,] 0.006837130
##  [60,] 0.006587029
##  [61,] 0.007488012
##  [62,] 0.007575989
##  [63,] 0.006588936
##  [64,] 0.006681919
##  [65,] 0.006973028
##  [66,] 0.006538868
##  [67,] 0.006556988
##  [68,] 0.006472111
##  [69,] 0.006499052
##  [70,] 0.006425858
##  [71,] 0.006868839
##  [72,] 0.007339001
##  [73,] 0.009589911
##  [74,] 0.006835222
##  [75,] 0.006718159
##  [76,] 0.006380081
##  [77,] 0.006325006
##  [78,] 0.006348848
##  [79,] 0.006958961
##  [80,] 0.007820845
##  [81,] 0.006683826
##  [82,] 0.006677151
##  [83,] 0.007093906
##  [84,] 0.007679939
##  [85,] 0.007685900
##  [86,] 0.008035898
##  [87,] 0.007606030
##  [88,] 0.010283947
##  [89,] 0.007753849
##  [90,] 0.006692886
##  [91,] 0.006903172
##  [92,] 0.006788015
##  [93,] 0.006423950
##  [94,] 0.006469011
##  [95,] 0.006374121
##  [96,] 0.007312059
##  [97,] 0.007508039
##  [98,] 0.008077860
##  [99,] 0.006819963
## [100,] 0.006520987
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain confidence intervals \& estimates for all coefficients, intercept.}
\FunctionTok{apply}\NormalTok{(result\_LD[[}\DecValTok{1}\NormalTok{]], }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{), mean, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            estimate       2.5%     97.5%
## Intercept 20.014130 19.8316495 20.196610
## Wind       1.023355  0.8245039  1.222206
## Temp       2.069596  1.8887159  2.250476
## Month      3.021985  2.8511103  3.192860
## Day        4.033573  3.8658807  4.201265
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res }\OtherTok{\textless{}{-}}\NormalTok{ result\_LD[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{true }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{RB }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"estimate"}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{ true}
\NormalTok{PB }\OtherTok{\textless{}{-}} \DecValTok{100} \SpecialCharTok{*} \FunctionTok{abs}\NormalTok{((}\FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"estimate"}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{ true)}\SpecialCharTok{/}\NormalTok{ true)}
\NormalTok{CR }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"2.5\%"}\NormalTok{] }\SpecialCharTok{\textless{}}\NormalTok{ true }\SpecialCharTok{\&}\NormalTok{ true }\SpecialCharTok{\textless{}}\NormalTok{ res[,, }\StringTok{"97.5\%"}\NormalTok{])}
\NormalTok{AW }\OtherTok{\textless{}{-}} \FunctionTok{rowMeans}\NormalTok{(res[,, }\StringTok{"97.5\%"}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ res[,, }\StringTok{"2.5\%"}\NormalTok{])}
\NormalTok{RMSE }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{rowMeans}\NormalTok{((res[,, }\StringTok{"estimate"}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ true)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
\FunctionTok{data.frame}\NormalTok{(RB, PB, CR, AW, RMSE)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   RB         PB   CR        AW       RMSE
## Intercept 0.01412967 0.07064837 1.00 0.3649604 0.04946551
## Wind      0.02335495 2.33549497 1.00 0.3977020 0.05633452
## Temp      0.06959586 3.47979321 0.98 0.3617599 0.08869656
## Month     0.02198526 0.73284197 1.00 0.3417499 0.04601087
## Day       0.03357291 0.83932276 1.00 0.3353844 0.05205810
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mean time for 100 instances of LD}
\NormalTok{times\_LD }\OtherTok{\textless{}{-}}\NormalTok{ result\_LD[[}\DecValTok{2}\NormalTok{]]}
\FunctionTok{mean}\NormalTok{(times\_LD)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.007222576
\end{verbatim}

\end{document}
